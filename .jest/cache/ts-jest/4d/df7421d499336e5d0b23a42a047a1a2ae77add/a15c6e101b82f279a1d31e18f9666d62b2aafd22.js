import * as Rx from 'rxjs';
import { parseRequestError } from 'utils/request/error';
import { isActionOf } from 'states/utils/action';
import * as actions from 'states/albums/actions';
import search from 'api/albums';
export const fetchEpic = action$ => (action$
    .filter(isActionOf(actions.fetch))
    .mergeMap(({ payload }) => (Rx.Observable.concat(Rx.Observable.of(actions.fetchLoading()), Rx.Observable.fromPromise(search.get(payload))
    .mergeMap(response => (Rx.Observable.concat(Rx.Observable.of(actions.receive(response)), Rx.Observable.of(actions.fetchSuccess()))))
    .catch((requestError) => (Rx.Observable.fromPromise(parseRequestError(requestError)
    .then(error => actions.fetchFailure(error))
    .catch(error => actions.fetchFailure(error)))))))));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tlaXN1a2VraWRvL3Byb2plY3RzL2l0dW5lc0ZldGNoZXIvc3JjL3N0YXRlcy9hbGJ1bXMvZXBpYy9mZXRjaC9pbmRleC50cyIsIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUkzQixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFakQsT0FBTyxLQUFLLE9BQU8sTUFBTSx1QkFBdUIsQ0FBQztBQUNqRCxPQUFPLE1BQU0sTUFBTSxZQUFZLENBQUM7QUFJaEMsTUFBTSxDQUFDLE1BQU0sU0FBUyxHQUlsQixPQUFPLENBQUMsRUFBRSxDQUFDLENBQ2IsT0FBTztLQUNKLE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ2pDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQ3pCLEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUNsQixFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsRUFDeEMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztLQUMzQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUNwQixFQUFFLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FDbEIsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUMzQyxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FDekMsQ0FDRixDQUFDO0tBQ0QsS0FBSyxDQUFDLENBQUMsWUFBMEIsRUFBRSxFQUFFLENBQUMsQ0FDckMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDO0tBQ3RELElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDMUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUM3QyxDQUNGLENBQUMsQ0FDTCxDQUNGLENBQUMsQ0FDTCxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9rZWlzdWtla2lkby9wcm9qZWN0cy9pdHVuZXNGZXRjaGVyL3NyYy9zdGF0ZXMvYWxidW1zL2VwaWMvZmV0Y2gvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUnggZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBFcGljIH0gZnJvbSAncmVkdXgtb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBBY3Rpb25zT2YgfSBmcm9tICd0eXBlcy9zdGF0ZSc7XG5pbXBvcnQgeyBSZXF1ZXN0RXJyb3IgfSBmcm9tICd0eXBlcy9yZXF1ZXN0JztcbmltcG9ydCB7IHBhcnNlUmVxdWVzdEVycm9yIH0gZnJvbSAndXRpbHMvcmVxdWVzdC9lcnJvcic7XG5pbXBvcnQgeyBpc0FjdGlvbk9mIH0gZnJvbSAnc3RhdGVzL3V0aWxzL2FjdGlvbic7XG5pbXBvcnQgeyBSb290U3RhdGUgfSBmcm9tICdzdGF0ZXMvcm9vdC9yZWR1Y2VyJztcbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSAnc3RhdGVzL2FsYnVtcy9hY3Rpb25zJztcbmltcG9ydCBzZWFyY2ggZnJvbSAnYXBpL2FsYnVtcyc7XG5cbnR5cGUgQWN0aW9ucyA9IEFjdGlvbnNPZjx0eXBlb2YgYWN0aW9ucz47XG5cbmV4cG9ydCBjb25zdCBmZXRjaEVwaWM6IEVwaWM8XG4gIEFjdGlvbnMsXG4gIEFjdGlvbnMsXG4gIFJvb3RTdGF0ZVxuPiA9IGFjdGlvbiQgPT4gKFxuICBhY3Rpb24kXG4gICAgLmZpbHRlcihpc0FjdGlvbk9mKGFjdGlvbnMuZmV0Y2gpKVxuICAgIC5tZXJnZU1hcCgoeyBwYXlsb2FkIH0pID0+IChcbiAgICAgIFJ4Lk9ic2VydmFibGUuY29uY2F0PEFjdGlvbnM+KFxuICAgICAgICBSeC5PYnNlcnZhYmxlLm9mKGFjdGlvbnMuZmV0Y2hMb2FkaW5nKCkpLFxuICAgICAgICBSeC5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKHNlYXJjaC5nZXQocGF5bG9hZCkpXG4gICAgICAgICAgLm1lcmdlTWFwKHJlc3BvbnNlID0+IChcbiAgICAgICAgICAgIFJ4Lk9ic2VydmFibGUuY29uY2F0PEFjdGlvbnM+KFxuICAgICAgICAgICAgICBSeC5PYnNlcnZhYmxlLm9mKGFjdGlvbnMucmVjZWl2ZShyZXNwb25zZSkpLFxuICAgICAgICAgICAgICBSeC5PYnNlcnZhYmxlLm9mKGFjdGlvbnMuZmV0Y2hTdWNjZXNzKCkpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSlcbiAgICAgICAgICAuY2F0Y2goKHJlcXVlc3RFcnJvcjogUmVxdWVzdEVycm9yKSA9PiAoXG4gICAgICAgICAgICBSeC5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKHBhcnNlUmVxdWVzdEVycm9yKHJlcXVlc3RFcnJvcilcbiAgICAgICAgICAgICAgLnRoZW4oZXJyb3IgPT4gYWN0aW9ucy5mZXRjaEZhaWx1cmUoZXJyb3IpKVxuICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gYWN0aW9ucy5mZXRjaEZhaWx1cmUoZXJyb3IpKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICkpXG4gICAgICApXG4gICAgKSlcbik7XG5cbiJdLCJ2ZXJzaW9uIjozfQ==