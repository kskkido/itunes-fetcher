import * as Rx from 'rxjs';
import { parseRequestError } from 'utils/request/error';
import { isActionOf } from 'states/utils/action';
import * as actions from 'states/songs/actions';
import search from 'api/songs';
export const fetchEpic = action$ => (action$
    .filter(isActionOf(actions.fetch))
    .mergeMap(({ payload }) => (Rx.Observable.concat(Rx.Observable.of(actions.fetchLoading()), Rx.Observable.fromPromise(search.get(payload))
    .mergeMap(response => (Rx.Observable.concat(Rx.Observable.of(actions.receive(response)), Rx.Observable.of(actions.fetchSuccess()))))
    .catch((requestError) => (Rx.Observable.fromPromise(parseRequestError(requestError)
    .then(error => actions.fetchFailure(error))
    .catch(error => actions.fetchFailure(error)))))))));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tlaXN1a2VraWRvL3Byb2plY3RzL2l0dW5lc0ZldGNoZXIvc3JjL3N0YXRlcy9zb25ncy9lcGljL2ZldGNoL2luZGV4LnRzIiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBSTNCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVqRCxPQUFPLEtBQUssT0FBTyxNQUFNLHNCQUFzQixDQUFDO0FBQ2hELE9BQU8sTUFBTSxNQUFNLFdBQVcsQ0FBQztBQUkvQixNQUFNLENBQUMsTUFBTSxTQUFTLEdBSWxCLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FDYixPQUFPO0tBQ0osTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDakMsUUFBUSxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FDekIsRUFBRSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQ2xCLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxFQUN4QyxFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQzNDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQ3BCLEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUNsQixFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQzNDLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUN6QyxDQUNGLENBQUM7S0FDRCxLQUFLLENBQUMsQ0FBQyxZQUEwQixFQUFFLEVBQUUsQ0FBQyxDQUNyQyxFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUM7S0FDdEQsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUMxQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQzdDLENBQ0YsQ0FBQyxDQUNMLENBQ0YsQ0FBQyxDQUNMLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2tlaXN1a2VraWRvL3Byb2plY3RzL2l0dW5lc0ZldGNoZXIvc3JjL3N0YXRlcy9zb25ncy9lcGljL2ZldGNoL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJ4IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgRXBpYyB9IGZyb20gJ3JlZHV4LW9ic2VydmFibGUnO1xuaW1wb3J0IHsgQWN0aW9uc09mIH0gZnJvbSAndHlwZXMvc3RhdGUnO1xuaW1wb3J0IHsgUmVxdWVzdEVycm9yIH0gZnJvbSAndHlwZXMvcmVxdWVzdCc7XG5pbXBvcnQgeyBwYXJzZVJlcXVlc3RFcnJvciB9IGZyb20gJ3V0aWxzL3JlcXVlc3QvZXJyb3InO1xuaW1wb3J0IHsgaXNBY3Rpb25PZiB9IGZyb20gJ3N0YXRlcy91dGlscy9hY3Rpb24nO1xuaW1wb3J0IHsgUm9vdFN0YXRlIH0gZnJvbSAnc3RhdGVzL3Jvb3QvcmVkdWNlcic7XG5pbXBvcnQgKiBhcyBhY3Rpb25zIGZyb20gJ3N0YXRlcy9zb25ncy9hY3Rpb25zJztcbmltcG9ydCBzZWFyY2ggZnJvbSAnYXBpL3NvbmdzJztcblxudHlwZSBBY3Rpb25zID0gQWN0aW9uc09mPHR5cGVvZiBhY3Rpb25zPjtcblxuZXhwb3J0IGNvbnN0IGZldGNoRXBpYzogRXBpYzxcbiAgQWN0aW9ucyxcbiAgQWN0aW9ucyxcbiAgUm9vdFN0YXRlXG4+ID0gYWN0aW9uJCA9PiAoXG4gIGFjdGlvbiRcbiAgICAuZmlsdGVyKGlzQWN0aW9uT2YoYWN0aW9ucy5mZXRjaCkpXG4gICAgLm1lcmdlTWFwKCh7IHBheWxvYWQgfSkgPT4gKFxuICAgICAgUnguT2JzZXJ2YWJsZS5jb25jYXQ8QWN0aW9ucz4oXG4gICAgICAgIFJ4Lk9ic2VydmFibGUub2YoYWN0aW9ucy5mZXRjaExvYWRpbmcoKSksXG4gICAgICAgIFJ4Lk9ic2VydmFibGUuZnJvbVByb21pc2Uoc2VhcmNoLmdldChwYXlsb2FkKSlcbiAgICAgICAgICAubWVyZ2VNYXAocmVzcG9uc2UgPT4gKFxuICAgICAgICAgICAgUnguT2JzZXJ2YWJsZS5jb25jYXQ8QWN0aW9ucz4oXG4gICAgICAgICAgICAgIFJ4Lk9ic2VydmFibGUub2YoYWN0aW9ucy5yZWNlaXZlKHJlc3BvbnNlKSksXG4gICAgICAgICAgICAgIFJ4Lk9ic2VydmFibGUub2YoYWN0aW9ucy5mZXRjaFN1Y2Nlc3MoKSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApKVxuICAgICAgICAgIC5jYXRjaCgocmVxdWVzdEVycm9yOiBSZXF1ZXN0RXJyb3IpID0+IChcbiAgICAgICAgICAgIFJ4Lk9ic2VydmFibGUuZnJvbVByb21pc2UocGFyc2VSZXF1ZXN0RXJyb3IocmVxdWVzdEVycm9yKVxuICAgICAgICAgICAgICAudGhlbihlcnJvciA9PiBhY3Rpb25zLmZldGNoRmFpbHVyZShlcnJvcikpXG4gICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBhY3Rpb25zLmZldGNoRmFpbHVyZShlcnJvcikpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSlcbiAgICAgIClcbiAgICApKVxuKTtcblxuIl0sInZlcnNpb24iOjN9