import * as Rx from 'rxjs';
import { parseRequestError } from 'utils/request/error';
import { isActionOf } from 'states/utils/action';
import * as actions from 'states/albums/actions';
import search from 'api/albums';
export const fetchEpic = action$ => (action$
    .filter(isActionOf(actions.albumsFetch))
    .mergeMap(({ payload }) => (Rx.Observable.concat(Rx.Observable.of(actions.albumsFetchLoading()), Rx.Observable.fromPromise(search.get(payload))
    .mergeMap(response => (Rx.Observable.concat(Rx.Observable.of(actions.albumsReceive(response)), Rx.Observable.of(actions.albumsFetchSuccess()))))
    .catch((requestError) => (Rx.Observable.fromPromise(parseRequestError(requestError)
    .then(error => actions.albumsFetchFailure(error))
    .catch(error => actions.albumsFetchFailure(error)))))))));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tlaXN1a2VraWRvL3Byb2plY3RzL2l0dW5lc0ZldGNoZXIvc3JjL3N0YXRlcy9hbGJ1bXMvZXBpYy9mZXRjaC9pbmRleC50cyIsIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUkzQixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFHakQsT0FBTyxLQUFLLE9BQU8sTUFBTSx1QkFBdUIsQ0FBQztBQUNqRCxPQUFPLE1BQU0sTUFBTSxZQUFZLENBQUM7QUFJaEMsTUFBTSxDQUFDLE1BQU0sU0FBUyxHQUlsQixPQUFPLENBQUMsRUFBRSxDQUFDLENBQ2IsT0FBTztLQUNKLE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0tBQ3ZDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQ3pCLEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUNsQixFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxFQUM5QyxFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQzNDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQ3BCLEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUNsQixFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQ2pELEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQy9DLENBQ0YsQ0FBQztLQUNELEtBQUssQ0FBQyxDQUFDLFlBQTBCLEVBQUUsRUFBRSxDQUFDLENBQ3JDLEVBQUUsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLFlBQVksQ0FBQztLQUN0RCxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDaEQsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQ25ELENBQ0YsQ0FBQyxDQUNMLENBQ0YsQ0FBQyxDQUNMLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2tlaXN1a2VraWRvL3Byb2plY3RzL2l0dW5lc0ZldGNoZXIvc3JjL3N0YXRlcy9hbGJ1bXMvZXBpYy9mZXRjaC9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSeCBmcm9tICdyeGpzJztcbmltcG9ydCB7IEVwaWMgfSBmcm9tICdyZWR1eC1vYnNlcnZhYmxlJztcbmltcG9ydCB7IEFjdGlvbnNPZiB9IGZyb20gJ3R5cGVzL3N0YXRlJztcbmltcG9ydCB7IFJlcXVlc3RFcnJvciB9IGZyb20gJ3R5cGVzL3JlcXVlc3QnO1xuaW1wb3J0IHsgcGFyc2VSZXF1ZXN0RXJyb3IgfSBmcm9tICd1dGlscy9yZXF1ZXN0L2Vycm9yJztcbmltcG9ydCB7IGlzQWN0aW9uT2YgfSBmcm9tICdzdGF0ZXMvdXRpbHMvYWN0aW9uJztcbmltcG9ydCB7IFJvb3RTdGF0ZSB9IGZyb20gJ3N0YXRlcy9yb290L3JlZHVjZXInO1xuaW1wb3J0IHsgUm9vdEFjdGlvbnMgfSBmcm9tICdzdGF0ZXMvcm9vdC9hY3Rpb25zJztcbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSAnc3RhdGVzL2FsYnVtcy9hY3Rpb25zJztcbmltcG9ydCBzZWFyY2ggZnJvbSAnYXBpL2FsYnVtcyc7XG5cbnR5cGUgQWN0aW9ucyA9IEFjdGlvbnNPZjx0eXBlb2YgYWN0aW9ucz47XG5cbmV4cG9ydCBjb25zdCBmZXRjaEVwaWM6IEVwaWM8XG4gIFJvb3RBY3Rpb25zLFxuICBBY3Rpb25zLFxuICBSb290U3RhdGVcbj4gPSBhY3Rpb24kID0+IChcbiAgYWN0aW9uJFxuICAgIC5maWx0ZXIoaXNBY3Rpb25PZihhY3Rpb25zLmFsYnVtc0ZldGNoKSlcbiAgICAubWVyZ2VNYXAoKHsgcGF5bG9hZCB9KSA9PiAoXG4gICAgICBSeC5PYnNlcnZhYmxlLmNvbmNhdDxBY3Rpb25zPihcbiAgICAgICAgUnguT2JzZXJ2YWJsZS5vZihhY3Rpb25zLmFsYnVtc0ZldGNoTG9hZGluZygpKSxcbiAgICAgICAgUnguT2JzZXJ2YWJsZS5mcm9tUHJvbWlzZShzZWFyY2guZ2V0KHBheWxvYWQpKVxuICAgICAgICAgIC5tZXJnZU1hcChyZXNwb25zZSA9PiAoXG4gICAgICAgICAgICBSeC5PYnNlcnZhYmxlLmNvbmNhdDxBY3Rpb25zPihcbiAgICAgICAgICAgICAgUnguT2JzZXJ2YWJsZS5vZihhY3Rpb25zLmFsYnVtc1JlY2VpdmUocmVzcG9uc2UpKSxcbiAgICAgICAgICAgICAgUnguT2JzZXJ2YWJsZS5vZihhY3Rpb25zLmFsYnVtc0ZldGNoU3VjY2VzcygpKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICkpXG4gICAgICAgICAgLmNhdGNoKChyZXF1ZXN0RXJyb3I6IFJlcXVlc3RFcnJvcikgPT4gKFxuICAgICAgICAgICAgUnguT2JzZXJ2YWJsZS5mcm9tUHJvbWlzZShwYXJzZVJlcXVlc3RFcnJvcihyZXF1ZXN0RXJyb3IpXG4gICAgICAgICAgICAgIC50aGVuKGVycm9yID0+IGFjdGlvbnMuYWxidW1zRmV0Y2hGYWlsdXJlKGVycm9yKSlcbiAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGFjdGlvbnMuYWxidW1zRmV0Y2hGYWlsdXJlKGVycm9yKSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApKVxuICAgICAgKVxuICAgICkpXG4pO1xuXG4iXSwidmVyc2lvbiI6M30=